# Database Functions

> Auto-generated by `npm run update-schema` — 2026-02-08T12:10:30.531Z

| Function | Arguments | Returns | Language | Volatility | Security |
|----------|-----------|---------|----------|------------|----------|
| handle_new_user | — | trigger | plpgsql | VOLATILE | SECURITY DEFINER |

---

### handle_new_user

```sql
CREATE OR REPLACE FUNCTION public.handle_new_user()
 RETURNS trigger
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
BEGIN
  INSERT INTO public.users (id, email, name)
  VALUES (
    NEW.id,
    NEW.email,
    COALESCE(NEW.raw_user_meta_data->>'name', NEW.raw_user_meta_data->>'full_name', split_part(NEW.email, '@', 1))
  )
  ON CONFLICT (id) DO UPDATE SET
    email = EXCLUDED.email,
    name = COALESCE(EXCLUDED.name, users.name);
  RETURN NEW;
END;
$function$

```

